<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Buttonie</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="manifest" href="./site.webmanifest" />
    <link rel="shortcut icon" type="image/x-icon" href="./images/favicon.ico" />
    <!-- Generated with https://purgecss.com/api.html#usage -->
    <!-- <link rel="stylesheet" href="tachyons.min.css" /> -->
    <!-- <link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css" /> -->
    <!-- TODO: minify paper -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/papercss@1.7.0/dist/paper.min.css"
    />
    <!-- <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto&display=swap"
    /> -->
    <style>
      * {
        font-family: 'Neucha', sans-serif;
      }

      [x-cloak] {
        display: none;
      }
    </style>
    <script
      async
      src="https://cdn.jsdelivr.net/gh/aFarkas/lazysizes/lazysizes.min.js"
    ></script>
    <script
      async
      type="module"
      src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.5.0/dist/alpine.min.js"
    ></script>
    <script
      defer
      nomodule
      src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.5.0/dist/alpine-ie11.min.js"
    ></script>

    <script
      defer
      src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"
    ></script>

    <script defer src="functions.js"></script>
    <script defer src="main.js"></script>
  </head>

  <!-- x-init="created(); checkHash()"
    @hashchange.window="checkHash()" -->

  <body
    x-cloak
    x-data="data()"
    x-init="created()"
    class="container margin-top-small padding-small"
  >
    <!-- Navigation and header -->
    <nav class="border split-nav">
      <div class="nav-brand">
        <h3><a href="/">Buttonie</a></h3>
      </div>
      <div class="collapsible">
        <input id="collapsible1" type="checkbox" name="collapsible1" />
        <label for="collapsible1">
          <div class="bar1"></div>
          <div class="bar2"></div>
          <div class="bar3"></div>
        </label>
        <div class="collapsible-body">
          <ul class="inline">
            <template x-for="(item, index) in navLinks" :key="index">
              <li>
                <a
                  :href="item.href"
                  :title="item.title"
                  x-text="item.title"
                ></a>
              </li>
            </template>
          </ul>
        </div>
      </div>
    </nav>

    <main class="paper border border-5 shadow shadow-small">
      <!-- Notifications & Conditional Sections -->
      <div
        style="display:none"
        class="padding-top-small padding-left padding-right"
      >
        <!-- Progress Bar -->
        <div class="progress margin-top-small margin-bottom-small">
          <div class="bar success w-50"></div>
        </div>
        <hr class="margin-top margin-bottom" />

        <!-- Alerts -->
        <div class="row flex-spaces">
          <input class="alert-state" id="alert-1" type="checkbox" />
          <div class="alert alert-secondary dismissible">
            Alert-secondary
            <label class="btn-close" for="alert-1">X</label>
          </div>
          <input class="alert-state" id="alert-2" type="checkbox" />
          <div class="alert alert-success dismissible">
            Alert-success
            <label class="btn-close" for="alert-2">X</label>
          </div>
        </div>
        <hr class="margin-top margin-bottom" />
      </div>

      <!-- Main Content -->
      <div
        x-show="!ingame"
        class="padding-top-small padding-left padding-right"
      >
        <h3 class="margin-none">Joining a Game</h3>
        <h5 class="text-secondary margin-top-small">Let's get Connected!</h5>

        <form id="join-game" class="padding" x-on:submit.prevent>
          <div class="form-group">
            <label for="roomcode">Room Code</label>
            <input
              type="text"
              placeholder="enter 4 letter code"
              onkeyup="this.value = this.value.toUpperCase()"
              x-model="roomcode"
            />
          </div>

          <div class="form-group">
            <label for="name">Name</label>
            <input
              type="text"
              placeholder="enter your name"
              x-model="username"
            />
          </div>

          <button
            @click="join()"
            :disabled="username.length < 1 || roomcode.length < 4"
            class="btn-secondary btn-block"
          >
            <h4 class="margin-none">Join</h4>
          </button>

          <button
            @click="host()"
            :disabled="username.length < 1 || roomcode.length < 4"
            class="btn-success btn-block margin-top-small"
          >
            <h4 class="margin-none">Host</h4>
          </button>
        </form>
      </div>
      <h3 class="margin-small">Message Output</h3>
      <div
        id="messages"
        class="background-warning padding"
        style="height:10rem; max-height: 10rem; overflow-y: scroll;"
      >
        <template x-for="(item, index) in messages" :key="index">
          <p class="text-danger margin-none" style="margin-top:8px;">
            <span
              style="font-size: 1rem;"
              class="badge"
              :class="{ 'secondary': item.from != username, 'success' : item.from == 'server' }"
              x-text="item.from + ' :'"
            ></span>
            <span x-text="item.data"></span>
          </p>
        </template>
      </div>

      <!-- Message form -->
      <form id="messsage" x-on:submit.prevent>
        <div class="form-group">
          <input
            autocomplete="off"
            type="text"
            class="border-6 border"
            placeholder="enter a message"
            x-model="message"
          />

          <button @click="sendMessage()" class="btn-warning">
            Send
          </button>
        </div>
      </form>

      <!-- IDK what this is -->
      <div x-show="ingame" class="paper container container-xs">
        <button id="onsort" class="background-secondary">Online</button>
        <button id="offsort" class="background-success">Offline</button>
        <button id="allsort" class="background-primary">All</button>
      </div>
    </main>
    <div x-show="isHost" class="row">
      <h3
        style="text-align: center;"
        class="col-12 col text-muted padding-none margin-none"
      >
        You are the host
      </h3>
    </div>
  </body>
</html>
